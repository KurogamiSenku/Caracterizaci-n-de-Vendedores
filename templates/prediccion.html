<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Predicción - Vendedores Informales Chía</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap">
</head>
<body>
    <nav class="navbar">
        <div class="container">
            <a class="navbar-brand d-flex align-items-center" href="#">
                <img src="{{ url_for('static', filename='images/ESCUDO-COLOR-H.png') }}" alt="">
                <span class="ms-2">Proyecto Vendedores Chía</span>
            </a>
            <ul class="navbar-nav">
                <li class="nav-item">
                    <a class="nav-link" href="/">Inicio</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/datos">Datos</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" href="/prediccion">Predicción</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/graficas">Gráficas</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" href="/referencias">Referencias</a>
                </li>
            </ul>
        </div>
    </nav>

    <main class="container mt-4">
        <section id="prediction-section">
            <div class="section-title text-center mb-4">
                <h1>Predicción del Perfil del Vendedor</h1>
                <p class="lead">Ingrese las características del vendedor para predecir su nivel de vulnerabilidad</p>
            </div>
            
            <form id="prediction-form" method="POST" action="/prediccion" class="mt-4">
                <div class="row">
                    <div class="col-md-6">
                            <div class="form-group">
                                <label for="genero">Género:</label>
                                <select id="genero" name="genero" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Masculino">Masculino</option>
                                    <option value="Femenino">Femenino</option>
                                    <option value="Otro">Otro</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="edad">Edad:</label>
                                <input type="number" id="edad" name="edad" class="form-control" required placeholder="Ej: 25, 30, 40">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="adulto-mayor">Adulto Mayor:</label>
                                <select id="adulto-mayor" name="adulto-mayor" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="nacionalidad">Nacionalidad:</label>
                                <input type="text" id="nacionalidad" name="nacionalidad" class="form-control" required placeholder="Ej: Colombia, Venezuela, Ecuador">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="producto-venta">Producto que Vende:</label>
                                <input type="text" id="producto-venta" name="producto-venta" class="form-control" required placeholder="Ej: Comida, Artesanía, Ropa">
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="detalle-producto">Detalle del Producto:</label>
                                <input type="text" id="detalle-producto" name="detalle-producto" class="form-control" required placeholder="Ej: Arepas, Collares, Camisetas">
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="discapacidad">Persona en Discapacidad:</label>
                                <select id="discapacidad" name="discapacidad" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="victima-conflicto">Víctima Conflicto Armado:</label>
                                <select id="victima-conflicto" name="victima-conflicto" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="resguardo-indigena">Resguardo Indígena:</label>
                                <select id="resguardo-indigena" name="resguardo-indigena" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="identificado-lgbtiq">Identificado LGBTIQ+:</label>
                                <select id="identificado-lgbtiq" name="identificado-lgbtiq" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label for="pertenece-asociacion">Pertenece a Alguna Asociación:</label>
                                <select id="pertenece-asociacion" name="pertenece-asociacion" class="form-control" required>
                                    <option value="">Seleccione...</option>
                                    <option value="Si">Sí</option>
                                    <option value="No">No</option>
                                </select>
                            </div>
                        </div>
                    </div>
                
                <div class="d-grid gap-2 mt-4">
                    <button type="submit" class="btn btn-primary btn-lg">Predecir Vulnerabilidad</button>
                </div>
            </form>
            {% if show_results %}
            <div id="prediction-results">
                <div class="result-card">
                    {% if error %}
                        <div class="alert alert-danger">
                            <h4>Error</h4>
                            <p>{{ error }}</p>
                        </div>
                    {% else %}
                        <h3>Nivel de Vulnerabilidad Predicho:</h3>
                        {% if prediccion == "Alto" %}
                            <p class="vulnerability-high">{{ prediccion }}</p>
                        {% elif prediccion == "Medio" %}
                            <p class="vulnerability-medium">{{ prediccion }}</p>
                        {% else %}
                            <p class="vulnerability-low">{{ prediccion }}</p>
                        {% endif %}

                        <h4>Probabilidades:</h4>
                        {% for nivel, prob in probabilidades.items() %}
                            <p>{{ nivel }}: {{ prob }}%</p>
                            <div class="probability-bar">
                                <div class="probability-fill" style="--prob: {{ prob }}%;"></div>
                            </div>
                        {% endfor %}

                        <h4>Recomendaciones:</h4>
                        {% if prediccion == "Alto" %}
                            <ul>
                                <li>Prioridad alta para programas de apoyo social</li>
                                <li>Recomendado para subsidios especiales</li>
                                <li>Necesita acompañamiento continuo</li>
                            </ul>
                        {% elif prediccion == "Medio" %}
                            <ul>
                                <li>Beneficiario de programas de capacitación</li>
                                <li>Elegible para microcréditos</li>
                                <li>Seguimiento semestral recomendado</li>
                            </ul>
                        {% else %}
                            <ul>
                                <li>Potencial para programas de formalización</li>
                                <li>Elegible para capacitaciones avanzadas</li>
                                <li>Seguimiento anual suficiente</li>
                            </ul>
                        {% endif %}
                    {% endif %}
                </div>
            </div>
            {% endif %}                   
        </section>
    </main>

    <footer class="bg-light text-center py-4 mt-5">
        <p class="text-muted">
            Proyecto desarrollado por Jennifer Andrea Espitia Porras y Nicolas Gutiérrez Reyes. Universidad de Cundinamarca - 2025.
        </p>
    </footer>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
    <script>
        // Animación para las barras de probabilidad
        document.addEventListener('DOMContentLoaded', function() {
            const fills = document.querySelectorAll('.probability-fill');
            fills.forEach(fill => {
                const targetWidth = fill.style.width;
                fill.style.width = '0%';
                setTimeout(() => {
                    fill.style.width = targetWidth;
                }, 100);
            });
        });
    </script>
</body>
</html>